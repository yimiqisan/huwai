{% extends ../frame.html %}

{% block static %}
	<script language="javascript" src="{{ static_url('js/jquery.uploadify.min.js') }}" type="text/javascript"></script>
	<script language="javascript" src="{{ static_url('js/event.js') }}" type="text/javascript"></script>
	<script language="javascript" src="{{ static_url('js/jquery-ui.min.js') }}" type="text/javascript"></script>
	<script language="javascript" src="{{ static_url('js/jquery.tags.js') }}" type="text/javascript"></script>
	<script language="javascript" src="{{ static_url('js/tags.js') }}" type="text/javascript"></script>
	<script language="javascript" type="text/javascript">
		$(document).ready(function() {
			$('#nav-event').addClass("active");
			$("#poster").uploadify({
				swf				: '{{ static_url("js/uploadify.swf") }}',
				uploader		: '/a/image',
				checkExisting	: '/a/image/check',
				buttonText		: '点击上传',
				cancelImage		: '{{ static_url("img/uploadify-cancel.png") }}',
				auto			: true,
				fileObjName		: 'upload',
				onUploadSuccess : function (file, data, response) {
					$('#poster').html('<span><input type="hidden" name="logo" value="'+data+'"/>已上传</span>');
					$('#poster_queue').hide();
					},
				onError			: function (event, queueID, fileObj){alert("文件:" + fileObj.name + " 上传失败");}
			});
			Event.checka();
			$("input[rel=popover]").popover({trigger: 'focus'});
			$("textarea[rel=popover]").popover({trigger: 'focus', placement: 'top'});
			yhui.iTag.create($('#etag'), {
				id:'eventTags',
				eclass: 'span6',
				initTags: false,
				addedAble: false,
				editAble: true,
				tagSource:function(search, showChoices) {
					var that = this;
					var args = {'search': search.term, 'rel': 'event'};
					$.postJSON("/a/tag/list/", 'GET', args, function(response) {
						if (response.error){
							return alert(response.error);
						}
						showChoices(that._subtractArray(response.data, that.assignedTags()));
					});
				}
			});
			yhui.iTag.create($('#qtag'), {
				id:'equipTags',
				eclass: 'span6',
				initTags: false,
				addedAble: false,
				editAble: true,
				tagSource:function(search, showChoices) {
					var that = this;
					var args = {'search': search.term, 'rel': 'equip'};
					$.postJSON("/a/tag/list/", 'GET', args, function(response) {
						if (response.error){
							return alert(response.error);
						}
						showChoices(that._subtractArray(response.data, that.assignedTags()));
					});
				}
			});
		})
	</script>
	<link rel="stylesheet" type="text/css" href="{{ static_url('css/uploadify.css') }}"/>
	<link rel="stylesheet" type="text/css" href="{{ static_url('css/jquery-ui.css') }}"/>
	<link rel="stylesheet" type="text/css" href="{{ static_url('css/jquery.tags.css') }}"/>
	<link rel="stylesheet" type="text/css" href="{{ static_url('css/tagit.ui-zendesk.css') }}"/>
{% end %}

{% block bodyleft %}
	<form class="form-horizontal event-form bg-white" method="POST" action="/event/puba/">
		<fieldset>
			<legend>活动发布---第一步</legend>
			<div class="control-group">
				<label class="control-label" for="focusedInput">活动标题:</label>
				<div class="controls">
					<input class="input-xlarge" name="title" type="text" value="" rel="popover" data-content="标题是驴友们首先看到的东西哦，您的活动够不够吸引眼球，他很关键哦,所以小编提醒您要重视标题哦，亲！" data-original-title="真爱生命，重视标题">
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="focusedInput">宣传海报:</label>
				<div class="controls">
					<div id="poster">图片上传</div>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label">人员配置:</label>
				<div class="controls">
					<input name="members" class="input-xlarge" type="text" value="发起人：{{current_user}}">
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="inlineCheckboxes">活动属性:</label>
				<div class="controls">
					<label class="checkbox inline">
						 <input type="checkbox" name="is_merc" value="option1">商业
					</label>
					<label class="checkbox inline">
						<input type="checkbox" name="club" value="option2"> 公开
					</label>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="select01">难度系数</label>
				<div class="controls">
					<select name="level">
						<option>0.5</option>
						<option selected>1.0</option>
						<option>1.5</option>
						<option>2.0</option>
						<option>2.5</option>
						<option>3.0</option>
						<option>4.0</option>
						<option>5.0</option>
					</select>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="multiSelect">户外标签</label>
				<div class="controls">
					<div id="etag"></div>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="focusedInput">活动时间:</label>
				<div class="controls">
					<script>toggleDate("begin_time", 0,0,0)</script>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="focusedInput">活动地点:</label>
				<div class="controls">
					<input class="input-xlarge" name="place" type="text" value="" rel="popover" data-content="天南海北，海角天涯 天荒地老 海枯石烂 看着办吧！" data-original-title="施主自哪里来，往“哪里”去？">
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="textarea">行程安排:</label>
				<div class="controls">
					<textarea class="input-xlarge" name="schedule_tl" rows="3" style="width:500px;" rel="popover" data-content="亲爱的领队，有了行程安排您的活动将一切尽在掌握！" data-original-title="好的计划是成功的一半"></textarea>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="textarea">费用明细:</label>
				<div class="controls">
					<textarea class="input-xlarge" name="spend_tl" rows="3" style="width:500px;" rel="popover" data-content="俗话说穷家富路，这次活动需要准备多少银两，让大家清楚清楚吧" data-original-title="亲驴友，明算账"></textarea>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="textarea">装备要求:</label>
				<div class="controls">
					<div id="qtag"></div>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="textarea">注意事项:</label>
				<div class="controls">
					<textarea class="input-xlarge" name="attention_tl" rows="3" style="width:500px;" rel="popover" data-content="队伍里面难免会有一些第一次参加户外的初出毛驴(初出茅庐的小驴)，还请领队大人多多提醒啊" data-original-title="这个可以有"></textarea>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="textarea">免责声明:</label>
				<div class="controls">
					<textarea class="input-xlarge" name="declare_tl" rows="3" style="width:500px;" rel="popover" data-content="反正出了事儿，又不找我，嘿嘿" data-original-title="这个爱有没有"></textarea>
				</div>
			</div>
			<div class="form-actions">
				<input type="submit" class="btn btn-primary" value="进入下一步"/>
				<a class="btn" href="/event/" >取消</a>
			</div>
		</fieldset>
	</form>
{% end %}
{% block bodyright %}{% end %}
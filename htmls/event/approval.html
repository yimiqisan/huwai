{% extends ../frame.html %}
{% block static %}
	<script language="javascript" type="text/javascript">
		$(document).ready(function() {
			$('#nav-event').addClass("active");
			$('.btn-ajax-toggle').click(function () {
				var btn = $(this);
				btn.button('loading');
				var url = btn.attr("ajax-url");
				var kind = btn.attr("ajax-kind");
				var args = {'kind': kind, 'mark': btn.attr("id").replace("btn-", "")};
				$.postJSON(url, "POST", args, function(response) {
					if (response.error){
						return alert(response.error);
					}
					if (btn.attr("switch")) {
						btn.button('complete');
						btn.attr("switch", "");
					} else {
						btn.button('reset')
						btn.attr("switch", true);
					}
					btn.toggleClass('btn-primary');
				});
			});
		})
	</script>
{% end %}

{% block bodyleft %}
	<button id="btn-{ id }}" switch={ 123 }} ajax-kind="{ kind }}" ajax-url="/a/toggle/state" data-loading-text="提交中..." data-complete-text="报名成功" class="btn btn-primary btn-ajax-toggle">报名参加</button>
	<br/><br/><br/>
	<div class="accordion" id="accordion">
		{% for u in userlist %}
		<div class="accordion-group">
			<div class="accordion-heading">
				<div class="accordion-toggle">
				<a class="pull-left" style="display:block;width:90%;height:28px;" data-toggle="collapse" data-parent="#accordion" href="#{{ u['id'] }}">
					{{ u.get('nick', None) }}
				</a>
				<button id="btn-{{ u['id'] }}" switch={ 123 }} ajax-kind="{{ u['kind'] }}" ajax-url="/a/toggle/state" data-loading-text="提交中" data-complete-text="已通过" class="btn btn-primary btn-ajax-toggle">通过</button>
				</div>
			</div>
			<div id="{{ u['id'] }}" class="accordion-body collapse" style="height: 0px;">
				<div class="accordion-inner">
					{{ u }}
				</div>
			</div>
		</div>
		{% end %}
	</div>
{% end %}
{% block bodyright %}
	<a class="btn" href="/event/{{ eid }}/">回到活动</a>
{% end %}
{% extends ../frame.html %}

{% block static %}
	<script language="javascript" src="{{ static_url('js/jquery.uploadify.min.js') }}" type="text/javascript"></script>
	<script language="javascript" type="text/javascript">
		$(document).ready(function() {
			$("#poster").uploadify({
				swf				: '{{ static_url("js/uploadify.swf") }}',
				uploader		: '/a/avatar?uid={{uid}}',
				checkExisting	: '/a/image/check',
				buttonText		: '点击上传',
				cancelImage		: '{{ static_url("img/uploadify-cancel.png") }}',
				auto			: true,
				scriptData		: {'uid':'{{ uid }}'},
				fileObjName		: 'upload',
				onUploadSuccess : function (file, data, response) {
					//$('#poster').html('<img src="/image/avatar/'+data+'_300"/>');
					$('#poster').html('<input type="hidden" value="'+data+'"/><img src="/image/avatar/'+data+'_30"/>');
					$('#poster_queue').hide();
					},
				onError			: function (event, queueID, fileObj){alert("文件:" + fileObj.name + " 上传失败");}
			});
		})
	</script>
	<link rel="stylesheet" type="text/css" href="{{ static_url('css/uploadify.css') }}"/>
	{% block static-added %}{% end %}
{% end %}
{% block bodyleft %}
	<div id="tab">
		<div class="Menubox">
			<ul>
				<li id="one1" onclick="setTab('one',1,4)" class="hover">基本设置</li>
				<li id="one2" onclick="setTab('one',2,4)" style="display:none;">消息提示</li>
				<li id="one3" onclick="setTab('one',3,4)" style="display:none;">微博绑定</li>
				<li id="one4" onclick="setTab('one',4,4)" style="display:none;">邮件提醒</li>
			</ul>
		</div>
		<div class="contentbox">
			<div id="con_one_1" class="hover">
				<form name="content-form" method="POST" action="/account/setting/">
					<div class="li"><label class="lil">名号: <em class="needed">30天更改一次</em></label><div class="lir">{{current_user}}<input type="hidden" name="nick" value="{{current_user}}"/>&nbsp&nbsp&nbsp&nbsp<a>更改</a></div></div>
					<div class="li"><label class="lil">我的域名: <em class="needed"></em></label><div class="lir">
						{% if ifNone(domain) %}
							<span>{{domain}}</span>
						{% else %}
							<input type="text" name="domain" value=""/>
						{% end %}
					</div></div>
					<div class="li"><label class="lil">头像: <em class="needed"></em></label><div class="lir">
				{% if ifNone(uid) %}<span>已上传</span>{% else %}<div id="poster">Uploadify</div>{% end %}
					</div></div>
					<div class="li"><label class="lil">常居地: <em class="needed"></em></label><div class="lir">
						{% if ifNone(live) %}
							<script>select_pid("live", {{live}})</script>
						{% else %}
							<script>select_pid("live", 1)</script>
							<span id="live"></span>
						{% end %}
					</div></div>
					<div class="li"><label class="lil">绑定邮箱: <em class="needed"></em></label><div class="lir">
						{% if ifNone(mail) %}
							<span>已绑定邮箱</span>&nbsp&nbsp&nbsp&nbsp<a>更改</a>
						{% else %}
							<input type="text" name="mail" value="{{ifNone(mail)}}"/>
						{% end %}
					</div></div>
					<div class="li"><label class="lil">密码: <em class="needed"></em></label><div class="lir"><a href="/account/cpassword/">修改密码</a></div></div>
					<div class="li"><label class="lil">手机号: <em class="needed"></em></label><div class="lir">
						{% if ifNone('phone') %}
							{% module Template("util/input_toggle.html", name="phone") %}
						{% else %}
							<span>phone</span>&nbsp&nbsp&nbsp&nbsp<a>取消绑定</a>
							<input type="text" name="phone" value=""/>
						{% end %}
					</div></div>
					<div class="li"><label class="lil"><em class="needed"></em></label><div class="lir"><input type="submit" value="提交"></div></div>
				</form>
			</div>
			<div id="con_one_2" style="display:none">消息提示</div>
			<div id="con_one_3" style="display:none">微博绑定</div>
			<div id="con_one_4" style="display:none">邮件提醒</div>
		</div>
	</div>
{% end %}
{% block bodyright %}{% end %}
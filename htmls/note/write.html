{% extends ../frame.html %}

{% block static %}
	<script type="text/javascript" src="{{ static_url('js/jquery.note.js') }}"></script>
	<script language="javascript" src="{{ static_url('js/jquery.uploadify.min.js') }}" type="text/javascript"></script>
	<script language="javascript" type="text/javascript">
		$(document).ready(function() {
			$('#nav-note').addClass("active");
			$("#poster").uploadify({
				swf				: '{{ static_url("js/uploadify.swf") }}',
				uploader		: '/a/image',
				checkExisting	: '/a/image/check',
				buttonText		: '点击上传',
				cancelImage		: '{{ static_url("img/uploadify-cancel.png") }}',
				auto			: true,
				fileObjName		: 'upload',
				onUploadSuccess : function (file, data, response) {
					var pic_num = $("#thumbnails li").length+1;
					var pic_name = " 图:"+pic_num+" ";
					$('#thumbnails').append('<li id="pic'+pic_num+'" class="span3 bg-white"><div class="thumbnail" style="min-height:100px;"><div style="float:left; clear:right;margin-right:10px;"><img src="/image/attach/'+data+'" style="width:80px;height:80px;margin-bottom:5px;" width=100 height=100 /></div><div class="span1" style="margin:10px 10px;display:block;width:100px;"><a rel="'+pic_num+'" href="" onclick="yhui.iNote.delPic(this);return false;">删除</a><p class="pull-right">'+pic_name+'</p></div><br/><br/><br/><label class="radio inline" style="margin-left:5px;"><input type="radio" name="pos'+pic_num+'" id="RadioLeft" value="-1">左</label><label class="radio inline" style="margin-left:5px;"><input type="radio" name="pos'+pic_num+'" id="RadioMiddle" value="0" checked>中</label><label class="radio inline" style="margin-left:5px;"><input type="radio" name="pos'+pic_num+'" id="RadioRight" value="1">右</label><textarea style="width:200px;"></textarea></div></li>');
					var note_text = $('#note_text').val()+pic_name;
					$('#note_text').val(note_text).focus();
					$('#image').modal('hide');
				},
				onError			: function (event, queueID, fileObj){alert("文件:" + fileObj.name + " 上传失败");}
			});
			yhui.iNote.init();
		})
	</script>
	<link rel="stylesheet" type="text/css" href="{{ static_url('css/note.css') }}"/>
	<link rel="stylesheet" type="text/css" href="{{ static_url('css/uploadify.css') }}"/>
{% end %}
{% block bodyleft %}
<form id="form_note" method="post" action="/note/write/">
	<div class="control-group">
		<label>题目:</label>
		<div><input id="note_title" name="note_title" type="text" class="span9"/></div>
	</div>
	<div class="control-group">
		<label class="pull-left">正文:</label>
		<div class="btn-group pull-right">
			<a class="btn" data-toggle="modal" href="#image" title="插入图片">图片</a>
		</div>
		<a class="btn hide" data-toggle="modal" href="#video" title="插入视频">视频</a>
		<a class="btn hide" data-toggle="modal" href="#href" title="插入链接">链接</a>
		<textarea id="note_text" name="note_text" class="span9" style="margin-top:3px;"></textarea>
	</div>
	<div class="">
		<a id="cancel_note" class="btn pull-left" href="/note/">取消</a>
		<input id="publish_note" class="btn btn-success pull-right" style="margin-left:10px;" value="发表" type="submit" name="note_submit" />
		<input id="preview_note" class="btn pull-right" value="预览" type="button" />
    </div>
</form>

<div id="image" class="modal hide fade">
	<div class="modal-header">
		<a class="close" data-dismiss="modal">×</a>
		<h3>插图</h3>
	</div>
	<div class="modal-body">
		<div id="poster">图片上传</div>
	</div>
</div>
<div id="video" class="modal hide fade">
	<div class="modal-header">
		<a class="close" data-dismiss="modal">×</a>
		<h3>视频</h3>
	</div>
	<div class="modal-body">
		<input type="text" />
	</div>
</div>
<div id="href" class="modal hide fade">
	<div class="modal-header">
		<a class="close" data-dismiss="modal">×</a>
		<h3>链接</h3>
	</div>
	<div class="modal-body">
		<input type="text" />
	</div>
</div>
{% end %}
{% block bodyright %}
	<input type="text" data-provide="typeahead" class="hide"/>
	<ul id="thumbnails" class="thumbnails"></ul>
{% end %}





